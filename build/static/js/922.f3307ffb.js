"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[922],{4922:(K,v,t)=>{t.r(v),t.d(v,{default:()=>H});var u=t(8160),O=t(108),D=t.n(O),b=t(3751),g=t(8081),R=t(414),N=t.n(R),E=t(6939),T=t(8721),x=t(455),U=t(5861),I=t(6761),P=t(9478),m=t(8160),y=Object.defineProperty,M=Object.defineProperties,V=Object.getOwnPropertyDescriptors,C=Object.getOwnPropertySymbols,k=Object.prototype.hasOwnProperty,G=Object.prototype.propertyIsEnumerable,S=(s,e,n)=>e in s?y(s,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):s[e]=n,j=(s,e)=>{for(var n in e||(e={}))k.call(e,n)&&S(s,n,e[n]);if(C)for(var n of C(e))G.call(e,n)&&S(s,n,e[n]);return s},L=(s,e)=>M(s,V(e)),w=(s,e,n)=>(S(s,typeof e!="symbol"?e+"":e,n),n),A=(s,e,n)=>new Promise((l,a)=>{var p=r=>{try{i(n.next(r))}catch(c){a(c)}},o=r=>{try{i(n.throw(r))}catch(c){a(c)}},i=r=>r.done?l(r.value):Promise.resolve(r.value).then(p,o);i((n=n.apply(s,e)).next())});const J=P.T.enableTranscription&&new(D())({NVM_INC:"/Users/shubhamingale/.nvm/versions/node/v18.9.0/include/node",TERM_PROGRAM:"vscode",NODE:"/usr/local/bin/node",INIT_CWD:"/Users/shubhamingale/Documents/develpement/ReactJS/2022/100ms-dopamine",NVM_CD_FLAGS:"-q",SHELL:"/bin/zsh",TERM:"xterm-256color",npm_config_metrics_registry:"https://registry.npmjs.org/",TMPDIR:"/var/folders/v9/p8jy6m854s70xj2d6fmpj1dr0000gn/T/",npm_config_global_prefix:"/usr/local",TERM_PROGRAM_VERSION:"1.74.2",MallocNanoZone:"0",ORIGINAL_XDG_CURRENT_DESKTOP:"undefined",COLOR:"1",npm_config_noproxy:"",npm_config_local_prefix:"/Users/shubhamingale/Documents/develpement/ReactJS/2022/100ms-dopamine",USER:"shubhamingale",NVM_DIR:"/Users/shubhamingale/.nvm",COMMAND_MODE:"unix2003",npm_config_globalconfig:"/usr/local/etc/npmrc",SSH_AUTH_SOCK:"/private/tmp/com.apple.launchd.2Ns3ViRzms/Listeners",__CF_USER_TEXT_ENCODING:"0x1F5:0x0:0x0",npm_execpath:"/usr/local/lib/node_modules/npm/bin/npm-cli.js",PATH:"/Users/shubhamingale/Documents/develpement/ReactJS/2022/100ms-dopamine/node_modules/.bin:/Users/shubhamingale/Documents/develpement/ReactJS/2022/node_modules/.bin:/Users/shubhamingale/Documents/develpement/ReactJS/node_modules/.bin:/Users/shubhamingale/Documents/develpement/node_modules/.bin:/Users/shubhamingale/Documents/node_modules/.bin:/Users/shubhamingale/node_modules/.bin:/Users/node_modules/.bin:/node_modules/.bin:/usr/local/lib/node_modules/npm/node_modules/@npmcli/run-script/lib/node-gyp-bin:/usr/local/bin:/System/Cryptexes/App/usr/bin:/usr/bin:/bin:/usr/sbin:/sbin:/usr/local/share/dotnet:~/.dotnet/tools:/Users/shubhamingale/.nvm/versions/node/v18.9.0/bin:/Users/shubhamingale/Downloads/google-cloud-sdk/bin",npm_package_json:"/Users/shubhamingale/Documents/develpement/ReactJS/2022/100ms-dopamine/package.json",_:"/Users/shubhamingale/Documents/develpement/ReactJS/2022/100ms-dopamine/node_modules/.bin/webpack",npm_config_userconfig:"/Users/shubhamingale/.npmrc",npm_config_init_module:"/Users/shubhamingale/.npm-init.js",__CFBundleIdentifier:"com.microsoft.VSCode",npm_command:"run-script",PWD:"/Users/shubhamingale/Documents/develpement/ReactJS/2022/100ms-dopamine",npm_lifecycle_event:"build",EDITOR:"vi",npm_package_name:"100ms_edtech_template",LANG:"en_GB.UTF-8",XPC_FLAGS:"0x0",VSCODE_GIT_ASKPASS_EXTRA_ARGS:"--ms-enable-electron-run-as-node",npm_config_node_gyp:"/usr/local/lib/node_modules/npm/node_modules/node-gyp/bin/node-gyp.js",npm_package_version:"0.1.5",XPC_SERVICE_NAME:"0",HOME:"/Users/shubhamingale",SHLVL:"2",VSCODE_GIT_ASKPASS_MAIN:"/Applications/Visual Studio Code.app/Contents/Resources/app/extensions/git/dist/askpass-main.js",npm_config_cache:"/Users/shubhamingale/.npm",LOGNAME:"shubhamingale",npm_lifecycle_script:"webpack --node-env production",VSCODE_GIT_IPC_HANDLE:"/var/folders/v9/p8jy6m854s70xj2d6fmpj1dr0000gn/T/vscode-git-2fa529c5b5.sock",NVM_BIN:"/Users/shubhamingale/.nvm/versions/node/v18.9.0/bin",npm_config_user_agent:"npm/8.19.1 node/v17.6.0 darwin arm64 workspaces/false",GIT_ASKPASS:"/Applications/Visual Studio Code.app/Contents/Resources/app/extensions/git/dist/askpass.sh",VSCODE_GIT_ASKPASS_NODE:"/Applications/Visual Studio Code.app/Contents/Frameworks/Code Helper.app/Contents/MacOS/Code Helper",npm_node_execpath:"/usr/local/bin/node",npm_config_prefix:"/usr/local",COLORTERM:"truecolor",NODE_ENV:"production"}.REACT_APP_TRANSCRIPTION_PUSHER_APP_KEY,{cluster:"ap2",authEndpoint:{NVM_INC:"/Users/shubhamingale/.nvm/versions/node/v18.9.0/include/node",TERM_PROGRAM:"vscode",NODE:"/usr/local/bin/node",INIT_CWD:"/Users/shubhamingale/Documents/develpement/ReactJS/2022/100ms-dopamine",NVM_CD_FLAGS:"-q",SHELL:"/bin/zsh",TERM:"xterm-256color",npm_config_metrics_registry:"https://registry.npmjs.org/",TMPDIR:"/var/folders/v9/p8jy6m854s70xj2d6fmpj1dr0000gn/T/",npm_config_global_prefix:"/usr/local",TERM_PROGRAM_VERSION:"1.74.2",MallocNanoZone:"0",ORIGINAL_XDG_CURRENT_DESKTOP:"undefined",COLOR:"1",npm_config_noproxy:"",npm_config_local_prefix:"/Users/shubhamingale/Documents/develpement/ReactJS/2022/100ms-dopamine",USER:"shubhamingale",NVM_DIR:"/Users/shubhamingale/.nvm",COMMAND_MODE:"unix2003",npm_config_globalconfig:"/usr/local/etc/npmrc",SSH_AUTH_SOCK:"/private/tmp/com.apple.launchd.2Ns3ViRzms/Listeners",__CF_USER_TEXT_ENCODING:"0x1F5:0x0:0x0",npm_execpath:"/usr/local/lib/node_modules/npm/bin/npm-cli.js",PATH:"/Users/shubhamingale/Documents/develpement/ReactJS/2022/100ms-dopamine/node_modules/.bin:/Users/shubhamingale/Documents/develpement/ReactJS/2022/node_modules/.bin:/Users/shubhamingale/Documents/develpement/ReactJS/node_modules/.bin:/Users/shubhamingale/Documents/develpement/node_modules/.bin:/Users/shubhamingale/Documents/node_modules/.bin:/Users/shubhamingale/node_modules/.bin:/Users/node_modules/.bin:/node_modules/.bin:/usr/local/lib/node_modules/npm/node_modules/@npmcli/run-script/lib/node-gyp-bin:/usr/local/bin:/System/Cryptexes/App/usr/bin:/usr/bin:/bin:/usr/sbin:/sbin:/usr/local/share/dotnet:~/.dotnet/tools:/Users/shubhamingale/.nvm/versions/node/v18.9.0/bin:/Users/shubhamingale/Downloads/google-cloud-sdk/bin",npm_package_json:"/Users/shubhamingale/Documents/develpement/ReactJS/2022/100ms-dopamine/package.json",_:"/Users/shubhamingale/Documents/develpement/ReactJS/2022/100ms-dopamine/node_modules/.bin/webpack",npm_config_userconfig:"/Users/shubhamingale/.npmrc",npm_config_init_module:"/Users/shubhamingale/.npm-init.js",__CFBundleIdentifier:"com.microsoft.VSCode",npm_command:"run-script",PWD:"/Users/shubhamingale/Documents/develpement/ReactJS/2022/100ms-dopamine",npm_lifecycle_event:"build",EDITOR:"vi",npm_package_name:"100ms_edtech_template",LANG:"en_GB.UTF-8",XPC_FLAGS:"0x0",VSCODE_GIT_ASKPASS_EXTRA_ARGS:"--ms-enable-electron-run-as-node",npm_config_node_gyp:"/usr/local/lib/node_modules/npm/node_modules/node-gyp/bin/node-gyp.js",npm_package_version:"0.1.5",XPC_SERVICE_NAME:"0",HOME:"/Users/shubhamingale",SHLVL:"2",VSCODE_GIT_ASKPASS_MAIN:"/Applications/Visual Studio Code.app/Contents/Resources/app/extensions/git/dist/askpass-main.js",npm_config_cache:"/Users/shubhamingale/.npm",LOGNAME:"shubhamingale",npm_lifecycle_script:"webpack --node-env production",VSCODE_GIT_IPC_HANDLE:"/var/folders/v9/p8jy6m854s70xj2d6fmpj1dr0000gn/T/vscode-git-2fa529c5b5.sock",NVM_BIN:"/Users/shubhamingale/.nvm/versions/node/v18.9.0/bin",npm_config_user_agent:"npm/8.19.1 node/v17.6.0 darwin arm64 workspaces/false",GIT_ASKPASS:"/Applications/Visual Studio Code.app/Contents/Resources/app/extensions/git/dist/askpass.sh",VSCODE_GIT_ASKPASS_NODE:"/Applications/Visual Studio Code.app/Contents/Frameworks/Code Helper.app/Contents/MacOS/Code Helper",npm_node_execpath:"/usr/local/bin/node",npm_config_prefix:"/usr/local",COLORTERM:"truecolor",NODE_ENV:"production"}.REACT_APP_TRANSCRIPTION_PUSHER_AUTHENDPOINT});let f=null;function H(){const[s,e]=(0,u.useState)(!1),[n,l]=(0,u.useState)(""),[a,p]=(0,u.useState)(""),o=(0,u.useRef)(null),i=(0,b._U)(g.j5),r=(0,b._U)(g.xf),c=(0,b.C1)(),h=(0,u.useCallback)((_=null)=>{o.current||(o.current=new F(l,p),o.current.enabled=!1),_!==!1&&(_=!s),o.current.enableTranscription(_),e(_)},[s]);return(0,u.useEffect)(()=>{f=J.subscribe(`private-${i}`),f.bind("client-transcription",({text:_})=>{if(_){let d=JSON.parse(_);d&&d.transcriptionConfig?h(!s&&d.transcriptionConfig.isEnabled):d&&d.peername&&d.transcript!==""&&(l(d.transcript),p("["+d.peername+"]"),d.isEnabled&&!s&&h(),setTimeout(()=>{l(""),p("")},5e3))}})},[i,s,h]),(0,u.useEffect)(()=>{!c||o.current&&s&&c.type===g.a5.PEER_JOINED&&o.current.broadcast(JSON.stringify({transcriptionConfig:{isEnabled:!0}}))},[c,s]),m.createElement(m.Fragment,null,m.createElement(E.x,{css:{textAlign:"left",fontWeight:"$medium",bottom:"120px",position:"fixed",width:"100%",fontSize:"$20px",zIndex:"1000000",color:"white",textShadow:"0px 0px 6px #000",whiteSpace:"pre-line",paddingLeft:"40px"}}),m.createElement(E.x,{css:{textAlign:"center",fontWeight:"$medium",bottom:"90px",position:"fixed",width:"100%",fontSize:"$20px",zIndex:"1000000",color:"white",textShadow:"0px 0px 6px #000",whiteSpace:"pre-line"}},m.createElement(T.x,{css:{color:"white",textShadow:"0px 0px 6px #000"}},n),m.createElement(T.x,{css:{color:"#c0bbbb",textShadow:"0px 0px 6px #000",textTransform:"capitalize"}},a)),r.audio&&m.createElement(x.u,{title:`Turn ${s?"off":"on"} transcription`},m.createElement(U.h,{active:!s,onClick:h,"data-testid":"transcription_btn"},m.createElement(I.Z,null))))}class F{constructor(e,n){w(this,"broadcast",(l,a="transcription")=>{f.trigger(`client-${a}`,{text:l,eventName:a})}),this.enabled=!1,this.socket=null,this.totalTimeDiff=0,this.totalCount=0,this.streams={},this.setTranscript=e,this.setSpeakingPeer=n,this.initialized=!1,this.lastMessage={},this.localPeerId=null,this.sttTuningConfig={timeSlice:250,desiredSampRate:8e3,numberOfAudioChannels:1,bufferSize:256}}listen(){return A(this,null,function*(){try{const e=window.__hms.sdk.getLocalPeer();this.localPeerId=e.peerId,this.streams[e.peerId]={stream:new MediaStream([e.audioTrack.nativeTrack]),name:e.name};let n={NVM_INC:"/Users/shubhamingale/.nvm/versions/node/v18.9.0/include/node",TERM_PROGRAM:"vscode",NODE:"/usr/local/bin/node",INIT_CWD:"/Users/shubhamingale/Documents/develpement/ReactJS/2022/100ms-dopamine",NVM_CD_FLAGS:"-q",SHELL:"/bin/zsh",TERM:"xterm-256color",npm_config_metrics_registry:"https://registry.npmjs.org/",TMPDIR:"/var/folders/v9/p8jy6m854s70xj2d6fmpj1dr0000gn/T/",npm_config_global_prefix:"/usr/local",TERM_PROGRAM_VERSION:"1.74.2",MallocNanoZone:"0",ORIGINAL_XDG_CURRENT_DESKTOP:"undefined",COLOR:"1",npm_config_noproxy:"",npm_config_local_prefix:"/Users/shubhamingale/Documents/develpement/ReactJS/2022/100ms-dopamine",USER:"shubhamingale",NVM_DIR:"/Users/shubhamingale/.nvm",COMMAND_MODE:"unix2003",npm_config_globalconfig:"/usr/local/etc/npmrc",SSH_AUTH_SOCK:"/private/tmp/com.apple.launchd.2Ns3ViRzms/Listeners",__CF_USER_TEXT_ENCODING:"0x1F5:0x0:0x0",npm_execpath:"/usr/local/lib/node_modules/npm/bin/npm-cli.js",PATH:"/Users/shubhamingale/Documents/develpement/ReactJS/2022/100ms-dopamine/node_modules/.bin:/Users/shubhamingale/Documents/develpement/ReactJS/2022/node_modules/.bin:/Users/shubhamingale/Documents/develpement/ReactJS/node_modules/.bin:/Users/shubhamingale/Documents/develpement/node_modules/.bin:/Users/shubhamingale/Documents/node_modules/.bin:/Users/shubhamingale/node_modules/.bin:/Users/node_modules/.bin:/node_modules/.bin:/usr/local/lib/node_modules/npm/node_modules/@npmcli/run-script/lib/node-gyp-bin:/usr/local/bin:/System/Cryptexes/App/usr/bin:/usr/bin:/bin:/usr/sbin:/sbin:/usr/local/share/dotnet:~/.dotnet/tools:/Users/shubhamingale/.nvm/versions/node/v18.9.0/bin:/Users/shubhamingale/Downloads/google-cloud-sdk/bin",npm_package_json:"/Users/shubhamingale/Documents/develpement/ReactJS/2022/100ms-dopamine/package.json",_:"/Users/shubhamingale/Documents/develpement/ReactJS/2022/100ms-dopamine/node_modules/.bin/webpack",npm_config_userconfig:"/Users/shubhamingale/.npmrc",npm_config_init_module:"/Users/shubhamingale/.npm-init.js",__CFBundleIdentifier:"com.microsoft.VSCode",npm_command:"run-script",PWD:"/Users/shubhamingale/Documents/develpement/ReactJS/2022/100ms-dopamine",npm_lifecycle_event:"build",EDITOR:"vi",npm_package_name:"100ms_edtech_template",LANG:"en_GB.UTF-8",XPC_FLAGS:"0x0",VSCODE_GIT_ASKPASS_EXTRA_ARGS:"--ms-enable-electron-run-as-node",npm_config_node_gyp:"/usr/local/lib/node_modules/npm/node_modules/node-gyp/bin/node-gyp.js",npm_package_version:"0.1.5",XPC_SERVICE_NAME:"0",HOME:"/Users/shubhamingale",SHLVL:"2",VSCODE_GIT_ASKPASS_MAIN:"/Applications/Visual Studio Code.app/Contents/Resources/app/extensions/git/dist/askpass-main.js",npm_config_cache:"/Users/shubhamingale/.npm",LOGNAME:"shubhamingale",npm_lifecycle_script:"webpack --node-env production",VSCODE_GIT_IPC_HANDLE:"/var/folders/v9/p8jy6m854s70xj2d6fmpj1dr0000gn/T/vscode-git-2fa529c5b5.sock",NVM_BIN:"/Users/shubhamingale/.nvm/versions/node/v18.9.0/bin",npm_config_user_agent:"npm/8.19.1 node/v17.6.0 darwin arm64 workspaces/false",GIT_ASKPASS:"/Applications/Visual Studio Code.app/Contents/Resources/app/extensions/git/dist/askpass.sh",VSCODE_GIT_ASKPASS_NODE:"/Applications/Visual Studio Code.app/Contents/Frameworks/Code Helper.app/Contents/MacOS/Code Helper",npm_node_execpath:"/usr/local/bin/node",npm_config_prefix:"/usr/local",COLORTERM:"truecolor",NODE_ENV:"production"}.REACT_APP_DYNAMIC_STT_TOKEN_GENERATION_ENDPOINT,a=yield(yield fetch(n)).json();if(a&&a.token){const p=a.token;this.socket=yield new WebSocket(`wss://api.assemblyai.com/v2/realtime/ws?sample_rate=${this.sttTuningConfig.desiredSampRate}&token=${p}`),this.setTranscript(""),this.socket.onmessage=o=>{try{const i=JSON.parse(o.data);if(i.text&&this.enabled){let r=this.streams[this.localPeerId].name,c=i.text.length>=80?i.text.split(" ").slice(Math.max(i.text.split(" ").length-10,1)).join(" "):i.text;this.setTranscript(c),this.setSpeakingPeer("[You]"),setTimeout(()=>{this.setTranscript(""),this.setSpeakingPeer("")},5e3),this.broadcast(JSON.stringify({peername:r,transcript:c,isEnabled:this.enabled}))}}catch(i){console.error("transcription",i)}},this.socket.onerror=o=>{console.error("transcription",o),this.socket.close()},this.socket.onclose=o=>{try{console.log(o),this.socket=null,this.enabled&&this.listen()}catch(i){console.error("transcription",i)}},this.socket.onopen=()=>{try{for(let o in this.streams)this.observeStream(this.streams[o].stream)}catch(o){console.error("transcription",o)}}}else console.log("Unable to fetch dynamic token!!")}catch(e){console.error("transcription",e)}})}observeStream(e){return A(this,null,function*(){new(N())(e,L(j({},this.sttTuningConfig),{type:"audio",mimeType:"audio/webm;codecs=pcm",recorderType:R.StereoAudioRecorder,ondataavailable:l=>{const a=new FileReader;a.onload=()=>{const p=a.result;if(this.socket&&this.enabled&&this.socket.readyState&&this.socket.readyState===1)try{this.socket.send(JSON.stringify({audio_data:p.split("base64,")[1]}))}catch(o){console.error("transcription",o)}},a.readAsDataURL(l)}})).startRecording()})}enableTranscription(e){e&&!this.enabled?(this.enabled=!0,this.listen(),this.broadcast(JSON.stringify({transcriptionConfig:{isEnabled:!0}}))):!e&&this.enabled&&(this.broadcast(JSON.stringify({transcriptionConfig:{isEnabled:!1}})),this.enabled=!1,this.socket.close(),this.socket=null,setTimeout(()=>{this.setTranscript("")},200))}}}}]);

//# sourceMappingURL=922.f3307ffb.js.map